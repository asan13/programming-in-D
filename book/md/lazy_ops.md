# Ленивые операторы

Ленивым вычислением называют oотсрочку вычисления выражения до момента,
когда потребуется результат этого вычисления.  В некоторых языках
программирования ленивые вычисления являются одной из фундаментальных
особенностей.

Естественно, эта задержка может заставить программы работать быстрее, если 
результаты в конечном итоге не нужны.

Похожую концепцию представляют следующие операторы с _коротким_ поведением:

- **||** (оператор _или_): Второе выражение вычисляется только, если первое 
  выражение **ложно**.

  ```D
    if (anExpression() || mayNotBeEvaluated()) {
        // ...
    }
  ```

  Если результат **anExpression()** - **истина**, результат выражения **||**
  безусловно **истина**.  Поскольку нет необходимости вычислять второе
  выражение для определения результата **||**, то второе выражение не 
  вычисляется.

- **&&** (оператор _и_): Второе выражение вычисляется только, если первое 
  выражение **истинно**. 

  ```D
    if (anExpression() && mayNotBeEvaluated()) {
        // ...
    }
  ```

  Если результат **anExpression()** - **ложь**, результат выражения **&&**
  безусловно **ложь**, поэтому второе выражение не вычисляется.

- **?:** (_тернарный_ оператор): Вычисляется либо первое, либо второе
  выражение, взависимости от того, является ли результат _condition_
  **истиной** или **ложью**, соответсвенно.

  ```D
    int i = condition() ? eitherThis() : orThis();
  ```

Ленивость этих операторов касается не только производительности. Иногда
вычисление одного из выражений является ошибкой.

Например, проверка условия, _является ли первая буква строки булкой А_ 
приведет к ошибке, если строка пуста:

```D
    dstring s;
    // ...
    if (s[0] == 'A') {
        // ...
    }
```

Для доступа к первому элементу **s** необходимо сначала убедиться, что строка
имеет этот элемент. По этой причине следующая проверка перемещает потенциально
ошибочное логическое выражение в правую часть оператора **&&**, чтобы 
гарантировать, что он будет оцениваться только тогда, когда это безопасно:

```D
    if ((s.length >= 1) && (s[0] == 'A')) {
        // ...
    }
```

Ленивости вычислений можно добиться, используя [указатели функций, делегаты](lambda.html)
и [ранги](ranges.html). Мы познакомимся с этим в следующих главах.
